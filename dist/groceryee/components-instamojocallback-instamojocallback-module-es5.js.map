{"version":3,"sources":["webpack:///src/app/components/instamojocallback/instamojocallback-routing.module.ts","webpack:///src/app/components/instamojocallback/instamojocallback.component.ts","webpack:///src/app/components/instamojocallback/instamojocallback.component.html","webpack:///src/app/components/instamojocallback/instamojocallback.module.ts"],"names":["routes","path","component","InstamojocallbackRoutingModule","forChild","imports","exports","InstamojocallbackComponent","route","api","util","cart","router","queryParams","subscribe","data","console","log","status","payment_status","payment_id","localStorage","getItem","deliveryAt","datetime","deliveryAddress","JSON","parse","couponadded","undefined","coupon","calcuate","createOrder","removeItem","navigate","payMethod","payKey","storeId","Set","map","item","store_id","orderStatus","forEach","element","info","id","push","notes","value","time","format","param","uid","join","date_time","add","paid_method","order_to","orders","stringify","address","driver_id","total","totalPrice","tax","orderTax","grand_total","grandTotal","delivery_charge","deliveryPrice","coupon_code","discount","pay_key","assignee","start","post","stop","createOrderNotification","stores","clearCart","publishNewOrder","error","toast","getString","selector","templateUrl","styleUrls","InstamojocallbackModule","declarations"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;AAcA,QAAMA,MAAM,GAAW,CACrB;AACEC,UAAI,EAAE,EADR;AAEEC,eAAS,EAAE;AAFb,KADqB,CAAvB;;QAWaC,8B;;;;;YAAAA;;;;yBAAAA,8B;AAA8B,O;AAAA,gBAHhC,CAAC,6DAAaC,QAAb,CAAsBJ,MAAtB,CAAD,CAGgC,EAF/B,4DAE+B;;;;0HAA9BG,8B,EAA8B;AAAA;AAAA,kBAF/B,4DAE+B;AAAA,O;AAFnB,K;;;;;sEAEXA,8B,EAA8B;cAJ1C,sDAI0C;eAJjC;AACRE,iBAAO,EAAE,CAAC,6DAAaD,QAAb,CAAsBJ,MAAtB,CAAD,CADD;AAERM,iBAAO,EAAE,CAAC,4DAAD;AAFD,S;AAIiC,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzB3C;;;;;;;;;;;QAqBaC,0B;;;AAGX,0CACUC,KADV,EAESC,GAFT,EAGSC,IAHT,EAISC,IAJT,EAKUC,MALV,EAKwB;AAAA;;AAAA;;AAJd,aAAAJ,KAAA,GAAAA,KAAA;AACD,aAAAC,GAAA,GAAAA,GAAA;AACA,aAAAC,IAAA,GAAAA,IAAA;AACA,aAAAC,IAAA,GAAAA,IAAA;AACC,aAAAC,MAAA,GAAAA,MAAA;AAER,aAAKJ,KAAL,CAAWK,WAAX,CAAuBC,SAAvB,CAAiC,UAACC,IAAD,EAAe;AAC9CC,iBAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCF,IAAxC;AACA,eAAI,CAACG,MAAL,GAAcH,IAAI,CAACG,MAAnB;;AACA,cAAIH,IAAI,IAAIA,IAAI,CAACI,cAAb,IAA+BJ,IAAI,CAACK,UAAxC,EAAoD;AAClDJ,mBAAO,CAACC,GAAR,CAAYI,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAZ;AACAN,mBAAO,CAACC,GAAR,CAAY,gCAAZ,EAA8CI,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAA9C;AACA,iBAAI,CAACX,IAAL,CAAUY,UAAV,GAAuBF,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAvB;AACA,iBAAI,CAACX,IAAL,CAAUa,QAAV,GAAqBH,YAAY,CAACC,OAAb,CAAqB,UAArB,CAArB;AACAN,mBAAO,CAACC,GAAR,CAAY,eAAZ,EAA6B,KAAI,CAACN,IAAL,CAAUa,QAAvC;AACAR,mBAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B,KAAI,CAACN,IAAL,CAAUY,UAApC,EAAgDF,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAhD;;AACA,gBAAI,KAAI,CAACX,IAAL,CAAUY,UAAV,KAAyB,MAA7B,EAAqC;AACnC,mBAAI,CAACZ,IAAL,CAAUc,eAAV,GAA4BC,IAAI,CAACC,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAX,CAA5B;AACD;;AACD,gBAAMM,WAAW,GAAGP,YAAY,CAACC,OAAb,CAAqB,aAArB,CAApB;AACAN,mBAAO,CAACC,GAAR,CAAY,oEAAZ,EAAkFW,WAAlF;;AACA,gBAAIA,WAAW,IAAIA,WAAW,KAAK,WAA/B,IAA8CA,WAAW,KAAKC,SAAlE,EAA6E;AAC3E,mBAAI,CAAClB,IAAL,CAAUmB,MAAV,GAAmBJ,IAAI,CAACC,KAAL,CAAWC,WAAX,CAAnB;AACD;;AACD,iBAAI,CAACjB,IAAL,CAAUoB,QAAV;;AACA,iBAAI,CAACC,WAAL,CAAiB,WAAjB,EAA8BjB,IAAI,CAACK,UAAnC;AACD,WAjBD,MAiBO;AACLC,wBAAY,CAACY,UAAb,CAAwB,cAAxB;AACAZ,wBAAY,CAACY,UAAb,CAAwB,YAAxB;AACAZ,wBAAY,CAACY,UAAb,CAAwB,iBAAxB;AACAZ,wBAAY,CAACY,UAAb,CAAwB,UAAxB;AACAZ,wBAAY,CAACY,UAAb,CAAwB,aAAxB;;AACA,iBAAI,CAACrB,MAAL,CAAYsB,QAAZ,CAAqB,CAAC,EAAD,CAArB;AACD;AACF,SA5BD;AA6BD;;;;oCAEiBC,S,EAAWC,M,EAAQ;;;;;;;;;;;AACnC;AACA;AAEMC,2B,sBAAc,IAAIC,GAAJ,CAAQ,KAAK3B,IAAL,CAAUA,IAAV,CAAe4B,GAAf,CAAmB,UAAAC,IAAI;AAAA,6BAAIA,IAAI,CAACC,QAAT;AAAA,qBAAvB,CAAR,C;AACdC,+B,GAAc,E;AACpBL,2BAAO,CAACM,OAAR,CAAgB,UAAAC,OAAO,EAAI;AACzB,0BAAMC,IAAI,GAAG;AACXC,0BAAE,EAAEF,OADO;AAEX1B,8BAAM,EAAE;AAFG,uBAAb;AAIAwB,iCAAW,CAACK,IAAZ,CAAiBF,IAAjB;AACD,qBAND;AAOMG,yB,GAAQ,CACZ;AACE9B,4BAAM,EAAE,CADV;AAEE+B,2BAAK,EAAE,eAFT;AAGEC,0BAAI,EAAE,mCAAM,GAAGC,MAAT,CAAgB,KAAhB;AAHR,qBADY,C;AAOd,yBAAKxC,IAAL,CAAUY,UAAV,GAAuB,KAAKZ,IAAL,CAAUY,UAAV,GAAuB,KAAKZ,IAAL,CAAUY,UAAjC,GAA8C,EAArE;AACM6B,yB,GAAQ;AACZC,yBAAG,EAAEhC,YAAY,CAACC,OAAb,CAAqB,KAArB,CADO;AAEZmB,8BAAQ,EAAEJ,OAAO,CAACiB,IAAR,EAFE;AAGZC,+BAAS,EAAE,KAAK5C,IAAL,CAAUa,QAAV,KAAuB,OAAvB,GAAiC,mCAAM,GAAG2B,MAAT,CAAgB,qBAAhB,CAAjC,GAA0E,mCAAM,GAAGK,GAAT,CAAa,CAAb,EAAgB,MAAhB,EAAwBL,MAAxB,CAA+B,qBAA/B,CAHzE;AAIZM,iCAAW,EAAEtB,SAJD;AAKZuB,8BAAQ,EAAE,KAAK/C,IAAL,CAAUY,UALR;AAMZoC,4BAAM,EAAEjC,IAAI,CAACkC,SAAL,CAAe,KAAKjD,IAAL,CAAUA,IAAzB,CANI;AAOZqC,2BAAK,EAAEtB,IAAI,CAACkC,SAAL,CAAeZ,KAAf,CAPK;AAQZa,6BAAO,EAAE,KAAKlD,IAAL,CAAUY,UAAV,KAAyB,MAAzB,GAAkCG,IAAI,CAACkC,SAAL,CAAe,KAAKjD,IAAL,CAAUc,eAAzB,CAAlC,GAA8E,EAR3E;AASZqC,+BAAS,EAAE,EATC;AAUZC,2BAAK,EAAE,KAAKpD,IAAL,CAAUqD,UAVL;AAWZC,yBAAG,EAAE,KAAKtD,IAAL,CAAUuD,QAXH;AAYZC,iCAAW,EAAE,KAAKxD,IAAL,CAAUyD,UAZX;AAaZC,qCAAe,EAAE,KAAK1D,IAAL,CAAU2D,aAbf;AAcZC,iCAAW,EAAE,KAAK5D,IAAL,CAAUmB,MAAV,GAAmBJ,IAAI,CAACkC,SAAL,CAAe,KAAKjD,IAAL,CAAUmB,MAAzB,CAAnB,GAAsD,EAdvD;AAeZ0C,8BAAQ,EAAE,KAAK7D,IAAL,CAAU6D,QAfR;AAgBZC,6BAAO,EAAErC,MAhBG;AAiBZlB,4BAAM,EAAEQ,IAAI,CAACkC,SAAL,CAAelB,WAAf,CAjBI;AAkBZgC,8BAAQ,EAAE;AAlBE,qB;AAqBd1D,2BAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BmC,KAA3B;AAEA,yBAAK1C,IAAL,CAAUiE,KAAV;AACA,yBAAKlE,GAAL,CAASmE,IAAT,CAAc,aAAd,EAA6BxB,KAA7B,EAAoCtC,SAApC,CAA8C,UAACC,IAAD,EAAe;AAC3DC,6BAAO,CAACC,GAAR,CAAYF,IAAZ;;AACA,4BAAI,CAACL,IAAL,CAAUmE,IAAV;;AACAxD,kCAAY,CAACY,UAAb,CAAwB,cAAxB;AACAZ,kCAAY,CAACY,UAAb,CAAwB,YAAxB;AACAZ,kCAAY,CAACY,UAAb,CAAwB,iBAAxB;AACAZ,kCAAY,CAACY,UAAb,CAAwB,UAAxB;AACAZ,kCAAY,CAACY,UAAb,CAAwB,aAAxB;;AACA,4BAAI,CAACxB,GAAL,CAASqE,uBAAT,CAAiC,MAAI,CAACnE,IAAL,CAAUoE,MAA3C;;AACA,4BAAI,CAACpE,IAAL,CAAUqE,SAAV;;AACA,4BAAI,CAACtE,IAAL,CAAUuE,eAAV;;AACA,4BAAI,CAACrE,MAAL,CAAYsB,QAAZ,CAAqB,CAAC,QAAD,CAArB;AACD,qBAZD,EAYG,UAAAgD,KAAK,EAAI;AACVlE,6BAAO,CAACC,GAAR,CAAYiE,KAAZ;;AACA,4BAAI,CAACxE,IAAL,CAAUmE,IAAV;;AACA,4BAAI,CAACnE,IAAL,CAAUyE,KAAV,CAAgB,OAAhB,EAAyB,MAAI,CAACzE,IAAL,CAAU0E,SAAV,CAAoB,OAApB,CAAzB,EAAuD,MAAI,CAAC1E,IAAL,CAAU0E,SAAV,CAAoB,sBAApB,CAAvD;AACD,qBAhBD;;;;;;;;;AAiBD;;;mCACO,CACP;;;;;;;uBAzGU7E,0B,EAA0B,+H,EAAA,wI,EAAA,0I,EAAA,0I,EAAA,uH;AAAA,K;;;YAA1BA,0B;AAA0B,4C;AAAA,c;AAAA,a;AAAA,2C;AAAA;AAAA;ACZvC;;AAAiC;;AAAgE;;;;AAAhE;;AAAA;;;;;;;;sEDYpBA,0B,EAA0B;cALtC,uDAKsC;eAL5B;AACT8E,kBAAQ,EAAE,uBADD;AAETC,qBAAW,EAAE,oCAFJ;AAGTC,mBAAS,EAAE,CAAC,oCAAD;AAHF,S;AAK4B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AErBvC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;QAuBaC,uB;;;;;YAAAA;;;;yBAAAA,uB;AAAuB,O;AAAA,gBALzB,CACP,4DADO,EAEP,gGAFO,CAKyB;;;;0HAAvBA,uB,EAAuB;AAAA,uBANnB,uFAMmB;AANO,kBAEvC,4DAFuC,EAGvC,gGAHuC;AAMP,O;AAHF,K;;;;;sEAGrBA,uB,EAAuB;cAPnC,sDAOmC;eAP1B;AACRC,sBAAY,EAAE,CAAC,uFAAD,CADN;AAERpF,iBAAO,EAAE,CACP,4DADO,EAEP,gGAFO;AAFD,S;AAO0B,Q","file":"components-instamojocallback-instamojocallback-module-es5.js","sourcesContent":["/*\n  Authors : initappz (Rahul Jograna)\n  Website : https://initappz.com/\n  App Name : ionic 5 groceryee app\n  Created : 10-Sep-2020\n  This App Template Source code is licensed as per the\n  terms found in the Website https://initappz.com/license\n  Copyright and Good Faith Purchasers © 2020-present initappz.\n*/\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { InstamojocallbackComponent } from './instamojocallback.component';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: InstamojocallbackComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class InstamojocallbackRoutingModule { }\n","/*\n  Authors : initappz (Rahul Jograna)\n  Website : https://initappz.com/\n  App Name : ionic 5 groceryee app\n  Created : 10-Sep-2020\n  This App Template Source code is licensed as per the\n  terms found in the Website https://initappz.com/license\n  Copyright and Good Faith Purchasers © 2020-present initappz.\n*/\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ApiService } from 'src/app/services/api.service';\nimport { UtilService } from 'src/app/services/util.service';\nimport { CartService } from 'src/app/services/cart.service';\nimport * as moment from 'moment';\n\n@Component({\n  selector: 'app-instamojocallback',\n  templateUrl: './instamojocallback.component.html',\n  styleUrls: ['./instamojocallback.component.scss']\n})\nexport class InstamojocallbackComponent implements OnInit {\n\n  status: any;\n  constructor(\n    private route: ActivatedRoute,\n    public api: ApiService,\n    public util: UtilService,\n    public cart: CartService,\n    private router: Router\n  ) {\n    this.route.queryParams.subscribe((data: any) => {\n      console.log('=======================>', data);\n      this.status = data.status;\n      if (data && data.payment_status && data.payment_id) {\n        console.log(localStorage.getItem('payTMOrderID'));\n        console.log('deliveryAddress===============', localStorage.getItem('deliveryAddress'));\n        this.cart.deliveryAt = localStorage.getItem('deliveryAt');\n        this.cart.datetime = localStorage.getItem('datetime');\n        console.log('date time->>>', this.cart.datetime);\n        console.log('cart--->>>', this.cart.deliveryAt, localStorage.getItem('deliveryAt'));\n        if (this.cart.deliveryAt === 'home') {\n          this.cart.deliveryAddress = JSON.parse(localStorage.getItem('deliveryAddress'));\n        }\n        const couponadded = localStorage.getItem('couponadded');\n        console.log('couponaddedcouponaddedcouponaddedcouponaddedcouponaddedcouponadded', couponadded);\n        if (couponadded && couponadded !== 'undefined' && couponadded !== undefined) {\n          this.cart.coupon = JSON.parse(couponadded);\n        }\n        this.cart.calcuate();\n        this.createOrder('instamojo', data.payment_id);\n      } else {\n        localStorage.removeItem('payTMOrderID');\n        localStorage.removeItem('deliveryAt');\n        localStorage.removeItem('deliveryAddress');\n        localStorage.removeItem('datetime');\n        localStorage.removeItem('couponadded');\n        this.router.navigate(['']);\n      }\n    });\n  }\n\n  async createOrder(payMethod, payKey) {\n    //////////// new\n    //////////// new\n\n    const storeId = [...new Set(this.cart.cart.map(item => item.store_id))];\n    const orderStatus = [];\n    storeId.forEach(element => {\n      const info = {\n        id: element,\n        status: 'created'\n      };\n      orderStatus.push(info);\n    });\n    const notes = [\n      {\n        status: 1,\n        value: 'Order Created',\n        time: moment().format('lll'),\n      }\n    ];\n    this.cart.deliveryAt = this.cart.deliveryAt ? this.cart.deliveryAt : '';\n    const param = {\n      uid: localStorage.getItem('uid'),\n      store_id: storeId.join(),\n      date_time: this.cart.datetime === 'today' ? moment().format('YYYY-MM-DD HH:mm:ss') : moment().add(1, 'days').format('YYYY-MM-DD HH:mm:ss'),\n      paid_method: payMethod,\n      order_to: this.cart.deliveryAt,\n      orders: JSON.stringify(this.cart.cart),\n      notes: JSON.stringify(notes),\n      address: this.cart.deliveryAt === 'home' ? JSON.stringify(this.cart.deliveryAddress) : '',\n      driver_id: '',\n      total: this.cart.totalPrice,\n      tax: this.cart.orderTax,\n      grand_total: this.cart.grandTotal,\n      delivery_charge: this.cart.deliveryPrice,\n      coupon_code: this.cart.coupon ? JSON.stringify(this.cart.coupon) : '',\n      discount: this.cart.discount,\n      pay_key: payKey,\n      status: JSON.stringify(orderStatus),\n      assignee: ''\n    };\n\n    console.log('param----->', param);\n\n    this.util.start();\n    this.api.post('orders/save', param).subscribe((data: any) => {\n      console.log(data);\n      this.util.stop();\n      localStorage.removeItem('payTMOrderID');\n      localStorage.removeItem('deliveryAt');\n      localStorage.removeItem('deliveryAddress');\n      localStorage.removeItem('datetime');\n      localStorage.removeItem('couponadded');\n      this.api.createOrderNotification(this.cart.stores);\n      this.cart.clearCart();\n      this.util.publishNewOrder();\n      this.router.navigate(['orders']);\n    }, error => {\n      console.log(error);\n      this.util.stop();\n      this.util.toast('error', this.util.getString('Error'), this.util.getString('Something went wrong'));\n    });\n  }\n  ngOnInit(): void {\n  }\n\n}\n","<!--\n   Authors : initappz (Rahul Jograna)\n  Website : https://initappz.com/\n  App Name : ionic 5 groceryee app\n  Created : 10-Sep-2020\n  This App Template Source code is licensed as per the\n  terms found in the Website https://initappz.com/license\n  Copyright and Good Faith Purchasers © 2020-present initappz.\n -->\n<h2 style=\"text-align: center;\"> {{util.getString('Please wait, we are processing your order')}} </h2>\n","/*\n  Authors : initappz (Rahul Jograna)\n  Website : https://initappz.com/\n  App Name : ionic 5 groceryee app\n  Created : 10-Sep-2020\n  This App Template Source code is licensed as per the\n  terms found in the Website https://initappz.com/license\n  Copyright and Good Faith Purchasers © 2020-present initappz.\n*/\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { InstamojocallbackRoutingModule } from './instamojocallback-routing.module';\nimport { InstamojocallbackComponent } from './instamojocallback.component';\n\n\n@NgModule({\n  declarations: [InstamojocallbackComponent],\n  imports: [\n    CommonModule,\n    InstamojocallbackRoutingModule\n  ]\n})\nexport class InstamojocallbackModule { }\n"]}